<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Wallet Profile</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://unpkg.com/bip39@3.0.4/browser/bip39.min.js"></script>
  <script src="https://unpkg.com/bip32@4.0.1/browser/bip32.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="https://unpkg.com/bitcoinjs-lib@6.1.0/browser.js"></script>
</head>
<body>
  <div class="container">
    <h1>üë§ –ü—Ä–æ—Ñ—ñ–ª—å –≥–∞–º–∞–Ω—Ü—è</h1>

    <div class="profile-row">
      <div class="label">üå± Seed-—Ñ—Ä–∞–∑–∞:</div>
      <textarea id="seed" rows="3" readonly></textarea>
    </div>

    <div class="profile-row">
      <div class="label">üí∞ ETH-–∞–¥—Ä–µ—Å–∞:</div>
      <div class="value" id="eth"></div>
    </div>

    <div class="profile-row">
      <div class="label">‚Çø BTC-–∞–¥—Ä–µ—Å–∞:</div>
      <div class="value" id="btc"></div>
    </div>

    <div class="profile-row">
      <div class="label">SOL-–∞–¥—Ä–µ—Å–∞:</div>
      <div class="value" id="sol"></div>
    </div>

    <div class="profile-row">
      <div class="label">BNB-–∞–¥—Ä–µ—Å–∞:</div>
      <div class="value" id="bnb"></div>
    </div>

    <div class="profile-row">
      <div class="label">ADA-–∞–¥—Ä–µ—Å–∞:</div>
      <div class="value" id="ada"></div>
    </div>

    <div class="profile-row">
      <div class="label">TRX-–∞–¥—Ä–µ—Å–∞:</div>
      <div class="value" id="trx"></div>
    </div>

    <div class="profile-row">
      <div class="label">DOT-–∞–¥—Ä–µ—Å–∞:</div>
      <div class="value" id="dot"></div>
    </div>

    <div class="profile-row">
      <div class="label">MATIC-–∞–¥—Ä–µ—Å–∞:</div>
      <div class="value" id="matic"></div>
    </div>

    <button class="button" onclick="openTelegram()">üîó –í—ñ–¥–∫—Ä–∏—Ç–∏ –≥–∞–º–∞–Ω–µ—Ü—å</button>
  </div>

  <script>
    const seedTextArea = document.getElementById('seed');

    window.addEventListener('DOMContentLoaded', async () => {
      console.log("üöÄ DOM –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ");

      // Telegram WebApp init
      if (window.Telegram && Telegram.WebApp) {
        Telegram.WebApp.expand();
        Telegram.WebApp.ready();
        const data = Telegram.WebApp.initDataUnsafe?.data || Telegram.WebApp.initData;
        const parsed = typeof data === "string" ? JSON.parse(data) : data;
        const seed = parsed?.seed || "";

        seedTextArea.value = seed;
        await deriveAddresses(seed);
      } else {
        seedTextArea.value = "‚ùå Telegram WebApp –Ω–µ –≤–∏—è–≤–ª–µ–Ω–æ";
      }
    });

    async function deriveAddresses(seed) {
      if (!bip39 || !bip39.validateMnemonic(seed)) {
        console.error("‚ùå –ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∞ seed-—Ñ—Ä–∞–∑–∞ –∞–±–æ bip39 –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ");
        return;
      }

      const seedBuffer = await bip39.mnemonicToSeed(seed);
      const root = bip32.fromSeed(seedBuffer);

      // ETH
      const ethPath = "m/44'/60'/0'/0/0";
      const ethNode = root.derivePath(ethPath);
      const ethWallet = new ethers.Wallet(ethNode.privateKey);
      document.getElementById("eth").textContent = ethWallet.address;

      // BTC
      const btcPath = "m/44'/0'/0'/0/0";
      const btcNode = root.derivePath(btcPath);
      const { payments } = bitcoin;
      const { address: btcAddr } = payments.p2pkh({ pubkey: btcNode.publicKey });
      document.getElementById("btc").textContent = btcAddr;

      // –Ü–Ω—à—ñ –∞–¥—Ä–µ—Å–∏ ‚Äî –∑–∞–≥–ª—É—à–∫–∏ –∞–±–æ –ø—ñ–∑–Ω—ñ—à–µ –æ–∫—Ä–µ–º–æ —á–µ—Ä–µ–∑ SDK/API
      document.getElementById("sol").textContent = "üü° solana-wallet-auto";
      document.getElementById("bnb").textContent = ethWallet.address;
      document.getElementById("ada").textContent = "üî¥ cardano-stub";
      document.getElementById("trx").textContent = "üßø tron-address";
      document.getElementById("dot").textContent = "üü† polkadot";
      document.getElementById("matic").textContent = ethWallet.address;
    }

    function openTelegram() {
      if (Telegram && Telegram.WebApp) {
        Telegram.WebApp.openLink("https://t.me/your_bot");
      }
    }
  </script>
</body>
</html>
